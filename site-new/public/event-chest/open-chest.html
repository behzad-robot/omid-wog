<html>

<head>
    {{{head}}}
    <link rel="stylesheet" href="/css/animate.min.css">
    <style>
        @font-face {
            font-family: Tanha;
            src: url('/event-chest/fonts/Tanha.eot');
            src: url('/event-chest/fonts/Tanha.woff') format('woff'),
                url('/event-chest/fonts/Tanha.ttf') format('truetype');
            font-weight: normal;
        }

        @font-face {
            font-family: Kamran;
            src: url('/event-chest/fonts/BKamran Bold_0.ttf');
            src: url('/event-chest/fonts/BKamran Outline_0.ttf') format('truetype'),
                url('/event-chest/fonts/BKamran_0.ttf') format('truetype');
            font-weight: normal;
        }

        .chest-section {
            padding-top: 10px;
            min-height: 100vh;
            background-image: url('/event-chest/aks.jpg');
        }

        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input {
            background: #222;
            background: linear-gradient(#333, #222);
            border: 1px solid rgb(68, 68, 68);
            border-radius: 5px 0 0 5px;
            box-shadow: 0 2px 0 #000;
            color: white;
            font-family: 'Tanha' !important;
            font-size: 20px !important;
            font-weight: 400 !important;
            height: 40px;
            margin: 0;
            padding: 0 10px;
            text-shadow: 0 -1px 0 #000;
            width: 200px;
            line-height: 40px;

        }

        input::-webkit-input-placeholder {
            color: white;
        }

        input:-moz-placeholder {
            color: white;
        }

        input:focus {
            animation: glow 800ms ease-out infinite alternate;
            background: #292522;
            background: linear-gradient(#393733, #292622);
            border-color: rgb(153, 109, 51);
            box-shadow: 0 0 5px rgba(255, 174, 0, 0.2), inset 0 0 5px rgba(255, 174, 0, 0.1), 0 2px 0 #000;
            color: white;
            outline: none;
        }

        input:focus::-webkit-input-placeholder {
            color: #efe;
        }

        input:focus:-moz-placeholder {
            color: #efe;
        }

        button {
            background: rgb(34, 34, 34);
            background: linear-gradient(rgb(51, 51, 51), rgb(34, 34, 34));
            box-sizing: border-box;
            border: 1px solid rgb(68, 68, 68);
            border-left-color: #000;
            border-radius: 0 5px 5px 0;
            box-shadow: 0 2px 0 #000;
            color: #fff;
            display: block;
            float: left;
            font-family: 'iransans' !important;
            font-size: 13px !important;
            font-weight: 400 !important;
            height: 40px;
            line-height: 40px;
            margin: 0;
            padding: 0;
            text-shadow: 0 -1px 0 #000;
            width: 80px;
        }

        button:hover,
        button:focus {
            background: #292929;
            background: linear-gradient(#393939, #292929);
            color: rgb(255, 195, 85);
            outline: none;
        }

        .btn-warning {
            color: white
        }

        .btn-warning:hover,
        .btn-warning:focus {
            color: white
        }

        button:active {
            background: #292929;
            background: linear-gradient(#393939, #292929);
            box-shadow: 0 1px 0 #000, inset 1px 0 1px #222;
            top: 1px;
        }

        @keyframes glow {
            0% {
                border-color: rgb(153, 105, 51);
                box-shadow: 0 0 5px rgba(255, 145, 0, 0.2), inset 0 0 5px rgba(255, 145, 0, 0.1), 0 2px 0 #000;
            }

            100% {
                border-color: rgb(255, 189, 102);
                box-shadow: 0 0 20px rgba(255, 174, 0, 0.6), inset 0 0 10px rgba(255, 174, 0, 0.4), 0 2px 0 #000;
            }
        }

        .form-control {
            color: white;
            border-color: orange
        }

        .form-control:focus {
            color: white;
        }
    </style>
    <style>
        @-webkit-keyframes blink {
            to {
                opacity: 0.0;
            }
        }

        @-moz-keyframes blink {
            to {
                opacity: 0.0;
            }
        }

        @-ms-keyframes blink {
            to {
                opacity: 0.0;
            }
        }

        @-o-keyframes blink {
            to {
                opacity: 0.0;
            }
        }

        @keyframes blink {
            to {
                opacity: 0.0;
            }
        }

        .static-text {
            font: italic bold 120px Kamran;
            color: white;
            text-shadow: 0px 0px 40px rgb(20, 228, 255), 0px 0px 40px rgb(20, 228, 255);
        }

        .blinking-text {
            font: italic bold 120px Kamran;
            color: white;
            text-shadow: 0px 0px 40px rgb(20, 228, 255), 0px 0px 40px rgb(20, 228, 255), 0px 0px 40px rgb(20, 228, 255);
            -webkit-animation-name: blink;
            -webkit-animation-duration: 1s;
            -webkit-animation-iteration-count: infinite;

            -moz-animation-name: blink;
            -moz-animation-duration: 1s;
            -moz-animation-iteration-count: infinite;

            -ms-animation-name: blink;
            -ms-animation-duration: 1s;
            -ms-animation-iteration-count: infinite;

            -o-animation-name: blink;
            -o-animation-duration: 1s;
            -o-animation-iteration-count: infinite;

            animation-name: blink;
            animation-duration: 1s;
            animation-iteration-count: infinite;
        }

        .looser-text {
            opacity: 0;
            font-size: 30px;
            margin-top:20px;
            color: red;
            text-shadow: 0px 0px 40px rgb(255, 20, 20), 0px 0px 40px rgb(255, 20, 20);
            transition: 300ms all;
        }

        .looser-text.active {
            opacity: 1;
        }

        body {
            background-color: #222222;
            background: repeating-linear-gradient(45deg, #2b2b2b 0%, #2b2b2b 10%, #222222 0%, #222222 50%) 0 / 15px 15px;
        }

        div {
            top: -50px;
        }
    </style>


    <style>
        @import url(https://fonts.googleapis.com/css?family=Exo+2:200i);

        :root {
            /* Base font size */
            font-size: 10px;

            /* Set neon color */
            --neon-text-color: gold;
            --neon-border-color: #08f;
        }

        h1 {
            font-size: 13rem;
            font-weight: 200;
            font-style: italic;
            color: #fff;
            padding: 4rem 6rem 5.5rem;
            border: 0.4rem solid #fff;
            border-radius: 2rem;
            text-transform: uppercase;
            animation: flicker 1.5s infinite alternate;
        }

        h1::-moz-selection {
            background-color: var(--neon-border-color);
            color: var(--neon-text-color);
        }

        h1::selection {
            background-color: var(--neon-border-color);
            color: var(--neon-text-color);
        }

        h1:focus {
            outline: none;
        }

        /* Animate neon flicker */
        @keyframes flicker {

            0%,
            19%,
            21%,
            23%,
            25%,
            54%,
            56%,
            100% {

                text-shadow:
                    -0.2rem -0.2rem 1rem #fff,
                    0.2rem 0.2rem 1rem #fff,
                    0 0 2rem var(--neon-text-color),
                    0 0 4rem var(--neon-text-color),
                    0 0 6rem var(--neon-text-color),
                    0 0 8rem var(--neon-text-color),
                    0 0 10rem var(--neon-text-color);

                box-shadow:
                    0 0 .5rem #fff,
                    inset 0 0 .5rem #fff,
                    0 0 2rem var(--neon-border-color),
                    inset 0 0 2rem var(--neon-border-color),
                    0 0 4rem var(--neon-border-color),
                    inset 0 0 4rem var(--neon-border-color);
            }

            20%,
            24%,
            55% {
                text-shadow: none;
                box-shadow: none;
            }
        }
    </style>

</head>

<body>
    <section class="chest-section">
        <div class="container-fluid">

            <div class="row">
                <div class="col-md-4">
                    <div style="margin-top: 100px" class="text-center">
                        <span class="static-text" style="display: block">آیا</span>
                        <span class="blinking-text" style="display: block">برنده بعدی </span>
                        <span class="static-text">شمایید?</span>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="text-center">
                        <h4 class="text-white"
                            style="margin-top: 80px;font-family: Kamran !important;font-size:80px !important;margin-bottom: 20px">
                            شانستو امتحان کن:</h4>
                        <form method="POST" action="/event-chest/open-chest/submit">
                            <input type="number" name="number" value="" placeholder="****" maxlength="4"
                                oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                                class="form-control text-center" />
                            <div class="text-center">
                                <input type="submit" value="ثبت" class="btn btn-md btn-warning"
                                    style="width: 30%;margin-top: 20px;" />
                            </div>
                        </form>
                        <h3 class="static-text looser-text" id="loosere-bad-bakht">
                            برنده نشدی :(</h3>
                        <video id="chest-video" style="margin-top: 10px" src="/event-chest/hexatech.mp4"
                            width="80%"></video>
                        <h1 id="winner-text" contenteditable spellcheck="false" style="margin-top:40px;display: none">
                            شما برنده شدید!
                        </h1>
                    </div>
                </div>
                <div class="col-md-4">
                    <div style="margin-top: 100px" class="text-center">
                        <span class="static-text" style="display: block">آیا</span>
                        <span class="blinking-text" style="display: block">برنده بعدی </span>
                        <span class="static-text">شمایید?</span>
                    </div>
                </div>
            </div>
            <script>
                var vid = document.getElementById("chest-video");
                function playVid()
                {
                    vid.play();
                }
                const element = document.getElementById('chest-video')
                $("form").ajaxForm({
                    beforeSubmit: (formData, jqForm, options) =>
                    {
                        var val = $("input[name=number]").val();
                        console.log(val);
                        if (isEmptyString(val))
                        {
                            alert('مقدار رمز را وارد کنید.');
                            return false;
                        }
                        val = parseInt(val);
                        if (val < 1000 && val <= 9999)
                        {
                            alert('مقدار رمز را وارد کنید.');
                            return false;
                        }
                        return true;
                    },
                    success: (text, code, xhr, form) =>
                    {
                        console.log(text);
                        if (text.code != 200)
                        {
                            alert(text.error);
                        }
                        else
                        {
                            if (text.winner)
                            {
                                $("#loosere-bad-bakht").css('display', 'none');
                                vid.play();
                                setTimeout(() =>
                                {
                                    $("#chest-video").css('display', 'none');
                                }, 2500);
                                setTimeout(() =>
                                {
                                    $("#winner-text").fadeIn(500)
                                }, 3000);
                            }
                            else
                            {
                                // $("#loosere-bad-bakht").css('opacity', '1');
                                // $("#loosere-bad-bakht").fadeIn(1000)
                                $("#loosere-bad-bakht").addClass("active");
                                element.classList.add('animated', 'shake');

                                setTimeout(() =>
                                {
                                    element.classList.remove('animated', 'shake');
                                }, 500);
                            }
                        }
                    },
                    error: (xhr, text, err) =>
                    {
                        alert('خطا از سمت سرور');
                    },
                });
            </script>
        </div>
    </section>
</body>

</html>